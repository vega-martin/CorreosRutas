{% extends "base.html" %}

{% block content %}

    <h1>Visualizador de puntos de parada</h1>

    <div class="formulario">
        <h2>Elegir fichero A</h2>
        <form method="POST" action="{{ url_for('fileUpload.upload_file_A') }}" enctype="multipart/form-data">
            <input type="file" name="fileA" accept=".csv" required>
            <input type="submit" value="Subir Fichero A">
        </form>
        <br>

        <h2>Elegir fichero B</h2>
        <form method="POST" action="{{ url_for('fileUpload.upload_file_B') }}" enctype="multipart/form-data">
            <input type="file" name="fileB" accept=".csv" required>
            <input type="submit" value="Subir Fichero B">
        </form>
        <br>

        <h2>Elegir fichero C</h2>
        <form method="POST" action="{{ url_for('fileUpload.upload_file_C') }}" enctype="multipart/form-data">
            <input type="file" name="fileC" accept=".csv" required>
            <input type="submit" value="Subir Fichero C">
        </form>
        <br>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <div>
        <form id="forms" method="POST" action="/generateResults">
            <h2>Seleccionar PDAs</h2>
            <select name="pdaSelect" id="pdaSelect" multiple>
                <!-- opciones aquí -->
            </select>
            <br>

            <h2>Seleccionar Fechas</h2>
            <label for="fechaInicio">Fecha de inicio:</label>
            <select name="fechaInicio" id="fechaInicio">
                <!-- opciones aquí -->
            </select>

            <label for="fechaFin">Fecha de final:</label>
            <select name="fechaFin" id="fechaFin">
                <!-- opciones aquí -->
            </select>
            <br>

            <input type="text" name="someTextInput"> <!-- Ejemplo de campo adicional -->

            <!-- Campo oculto para la acción -->
            <input type="hidden" name="action" id="action">

            <!-- Botones -->
            <button type="submit" onclick="setAction('generate_map')">Generar mapa</button>
            <button type="submit" onclick="setAction('detect_stops')">Detectar paradas</button>
            <button type="submit" onclick="setAction('generate_stops')">Generar mapa con puntos de paradas</button>
            <button type="submit" onclick="setAction('generate_graph')">Gráfica velocidad/tiempo</button>
        </form>

        <script>
            // Función para actualizar el campo oculto con la acción seleccionada
            function setAction(action) {
                document.getElementById('action').value = action;
            }
        </script>

    </div>

    <div class="mapa">
        <h2>Mapa generado</h2>
        <iframe id="mapaRenderizado" src="" width="100%" height="500px" style="border:1px solid #ccc;"></iframe>
        <br>
        <a id="descagarMapa" href="#" target="_blank">Descargar Mapa</a>
    </div>

{% endblock %}